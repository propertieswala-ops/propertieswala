<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />

  <title>PropertiesWala | Trusted Property Solutions Across West Bengal</title>
  <meta name="description" content="Verified Residential & Commercial Properties across West Bengal. Get honest advice, best deals and direct WhatsApp enquiry support." />

  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- ================= NAVBAR ================= -->
  <header class="navbar">
    <div class="nav-container">
      <div class="logo">
        Properties<span>Wala</span>
      </div>

      <nav class="nav-links">
        <a href="#home">Home</a>
        <a href="#properties">Properties</a>
        <a href="#contact">Contact</a>
      </nav>
    </div>
  </header>


  <!-- ================= HERO ================= -->
  <section id="home" class="hero">
    <div class="hero-overlay"></div>

    <div class="hero-content">
      <h1>Trusted Property Solutions Across West Bengal</h1>

      <p class="hero-subtitle">
        Residential & Commercial Properties • Honest Advice • Verified Listings
      </p>

      <div class="hero-search">
        <input type="text" placeholder="Search by location or property type (Coming Soon)" disabled />
      </div>

      <div class="filters">
        <button class="filter-btn active" data-filter="All">All</button>
        <button class="filter-btn" data-filter="Residential">Residential</button>
        <button class="filter-btn" data-filter="Commercial">Commercial</button>
      </div>
    </div>
  </section>


  <!-- ================= PROPERTIES ================= -->
  <section id="properties" class="properties-section">
    <h2>Latest Available Properties</h2>

    <div id="propertyGrid" class="property-grid">
      <!-- JS will render properties here -->
    </div>
  </section>


  <!-- ================= CONTACT ================= -->
  <section id="contact" class="contact-section">
    <h2>Contact Us</h2>

    <p>Speak directly with a property expert for verified listings and honest advice.</p>

    <div class="contact-box">
      <div class="contact-row">
        <strong>Call Now:</strong>
        <a class="contact-link" href="tel:+919433365152">+91 9433365152</a>
      </div>

      <div class="contact-row">
        <strong>WhatsApp:</strong>
        <a class="contact-link" target="_blank"
           href="https://wa.me/919433365152?text=Hello%20PropertiesWala%2C%20I%20need%20property%20details%20please.">
          Chat on WhatsApp
        </a>
      </div>
    </div>
  </section>


  <!-- ================= FOOTER ================= -->
  <footer class="footer">
    <p>© 2025 PropertiesWala. All rights reserved.</p>
  </footer>


  <!-- ================= JS (Google Sheet CSV) ================= -->
  <script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRgoZIBoAGvAYPO4Nz2se3QJ8aWENUUfYtLW7l25i3B0EkVzYzhgrtupPOIbPXuJ8N_wKf_E9ckipxv/pub?output=csv";

    const propertyGrid = document.getElementById("propertyGrid");
    const filterButtons = document.querySelectorAll(".filter-btn");

    let allProperties = [];
    let currentFilter = "All";

    function normalizeValue(v) {
      return (v || "").toString().trim();
    }

    function safeText(v) {
      return normalizeValue(v).replace(/</g, "&lt;").replace(/>/g, "&gt;");
    }

    function getWhatsAppLink(phone, message) {
      const cleanPhone = normalizeValue(phone).replace(/\D/g, "");
      const text = encodeURIComponent(message);
      return `https://wa.me/${cleanPhone}?text=${text}`;
    }

    function buildCard(item) {
      const type = safeText(item.Type);
      const location = safeText(item.Location);
      const area = safeText(item.Area);
      const price = safeText(item.Price);

      // IMPORTANT:
      // Your Google Sheet Image column contains FULL URL like:
      // https://propertieswala.in/image/PR1-Naktala-Kolkata.jpg
      const imageUrl = normalizeValue(item.Image);

      const whatsappPhone = normalizeValue(item.WhatsApp) || "919433365152";

      const message =
        `Hello PropertiesWala, I am interested in this property:\n\n` +
        `Type: ${type}\n` +
        `Location: ${location}\n` +
        `Area: ${area} sqft\n` +
        `Price: ${price}\n\n` +
        `Please share more details.`;

      const waLink = getWhatsAppLink(whatsappPhone, message);

      // If image URL is empty, show a fallback block
      const imgTag = imageUrl
        ? `<img src="${imageUrl}" alt="${type} in ${location}" loading="lazy" />`
        : `<div class="img-fallback">No Image</div>`;

      return `
        <div class="property-card">
          <div class="property-img">
            ${imgTag}
          </div>

          <div class="property-body">
            <h3>${type}</h3>

            <p><strong>Location:</strong> ${location}</p>
            <p><strong>Area:</strong> ${area} sqft</p>
            <p><strong>Price:</strong> ${price}</p>

            <a class="whatsapp-btn" target="_blank" href="${waLink}">
              WhatsApp Enquiry
            </a>
          </div>
        </div>
      `;
    }

    function renderProperties() {
      propertyGrid.innerHTML = "";

      const filtered = allProperties.filter(p => {
        const cat = normalizeValue(p.Category);
        if (currentFilter === "All") return true;
        return cat.toLowerCase() === currentFilter.toLowerCase();
      });

      if (filtered.length === 0) {
        propertyGrid.innerHTML = `<p class="no-data">No properties found.</p>`;
        return;
      }

      propertyGrid.innerHTML = filtered.map(buildCard).join("");
    }

    async function loadCSV() {
      try {
        const res = await fetch(CSV_URL);
        const csvText = await res.text();

        const rows = csvText.trim().split("\n").map(r => r.split(","));

        // Headers
        const headers = rows[0].map(h => h.trim());

        // Data rows
        const dataRows = rows.slice(1);

        allProperties = dataRows.map(row => {
          const obj = {};
          headers.forEach((h, i) => {
            obj[h] = row[i] ? row[i].trim() : "";
          });
          return obj;
        });

        renderProperties();

      } catch (err) {
        console.error("CSV Load Error:", err);
        propertyGrid.innerHTML = `<p class="no-data">Error loading properties. Please check the CSV link.</p>`;
      }
    }

    // Filter Buttons
    filterButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        filterButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentFilter = btn.getAttribute("data-filter");
        renderProperties();
      });
    });

    loadCSV();
  </script>

</body>
</html>
