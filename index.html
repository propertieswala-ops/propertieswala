<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>PropertiesWala | Verified Property Listings in Kolkata & West Bengal</title>
  <meta name="description" content="PropertiesWala provides verified residential & commercial property listings across Kolkata & West Bengal. Contact now for direct site visit support." />
  <link rel="canonical" href="https://propertieswala.in/" />

  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- ================= NAVBAR ================= -->
  <header class="navbar">
    <div class="nav-container">
      <div class="logo">
        Properties<span>Wala</span>
      </div>

      <nav class="nav-links">
        <a href="#home">Home</a>
        <a href="#properties">Properties</a>
        <a href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <!-- ================= HERO ================= -->
  <section id="home" class="hero">
    <div class="hero-overlay"></div>

    <div class="hero-content">
      <h1>Trusted Property Solutions Across West Bengal</h1>
      <p>Residential & Commercial Properties • Honest Advice • Verified Listings</p>

      <input class="hero-search" type="text" placeholder="Search by location or property type (Coming Soon)" disabled />

      <div class="filters">
        <button class="filter-btn active" data-filter="All">All</button>
        <button class="filter-btn" data-filter="Residential">Residential</button>
        <button class="filter-btn" data-filter="Commercial">Commercial</button>
      </div>
    </div>
  </section>

  <!-- ================= LEAD FORM (IMPORTANT) ================= -->
  <section class="lead-section">
    <div class="lead-box">
      <div class="lead-left">
        <h2>Get Call Back in 10 Minutes</h2>
        <p>Tell us your requirement. We will share matching verified options instantly.</p>

        <ul class="trust-points">
          <li>Verified Listings Only</li>
          <li>Direct Site Visit Support</li>
          <li>Kolkata & West Bengal Specialist</li>
        </ul>
      </div>

      <form id="leadForm" class="lead-form">
        <input type="text" id="leadName" placeholder="Your Name" required />
        <input type="tel" id="leadPhone" placeholder="Your Phone Number" required />

        <select id="leadCategory" required>
          <option value="">Select Category</option>
          <option value="Commercial">Commercial</option>
          <option value="Residential">Residential</option>
        </select>

        <select id="leadType" required>
          <option value="">Select Property Type</option>
          <option value="Retail Showroom">Retail Showroom</option>
          <option value="Office Space">Office Space</option>
          <option value="Apartment">Apartment</option>
          <option value="Land / Plot">Land / Plot</option>
          <option value="Other">Other</option>
        </select>

        <input type="text" id="leadBudget" placeholder="Budget (Example: 2.5 Cr / 70 Lakh)" required />
        <input type="text" id="leadArea" placeholder="Preferred Area (Example: Park Street, Kolkata)" required />

        <button type="submit" class="lead-submit">Send Requirement on WhatsApp</button>
      </form>
    </div>
  </section>

  <!-- ================= PROPERTIES ================= -->
  <section id="properties" class="properties-section">
    <h2>Latest Available Properties</h2>
    <div id="propertyGrid" class="property-grid"></div>

    <div id="loadingText" class="loading-text">Loading properties...</div>
  </section>

  <!-- ================= CONTACT ================= -->
  <section id="contact" class="contact-section">
    <h2>Contact Us</h2>
    <p>Speak directly with a property expert for verified listings and honest advice.</p>

    <div class="contact-card">
      <div>
        <strong>Call Now:</strong><br/>
        <a class="contact-link" href="tel:+919433365152">+91 9433365152</a>
      </div>

      <div>
        <strong>WhatsApp:</strong><br/>
        <a class="contact-link" target="_blank"
          href="https://wa.me/919433365152?text=Hello%20PropertiesWala%2C%20I%20want%20verified%20property%20options%20in%20Kolkata.">
          Chat on WhatsApp
        </a>
      </div>
    </div>
  </section>

  <!-- ================= FOOTER ================= -->
  <footer class="footer">
    <p>© 2026 PropertiesWala. All rights reserved.</p>
  </footer>

  <!-- ================= FLOATING BUTTONS ================= -->
  <a class="floating-btn floating-call" href="tel:+919433365152" title="Call Now">
    Call
  </a>

  <a class="floating-btn floating-wa"
    target="_blank"
    href="https://wa.me/919433365152?text=Hello%20PropertiesWala%2C%20I%20want%20property%20details%20and%20site%20visit%20support."
    title="WhatsApp Now">
    WhatsApp
  </a>

  <!-- ================= JAVASCRIPT ================= -->
  <script>
    // --------------- SETTINGS ---------------
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRgoZIBoAGvAYPO4Nz2se3QJ8aWENUUfYtLW7l25i3B0EkVzYzhgrtupPOIbPXuJ8N_wKf_E9ckipxv/pub?output=csv";
    const DEFAULT_WHATSAPP = "919433365152"; // your WhatsApp number

    let ALL_PROPERTIES = [];
    let ACTIVE_FILTER = "All";

    // --------------- HELPERS ---------------
    function escapeHTML(str) {
      if (!str) return "";
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function normalizeCategory(cat) {
      if (!cat) return "";
      const c = cat.trim().toLowerCase();
      if (c.includes("res")) return "Residential";
      if (c.includes("com")) return "Commercial";
      return cat.trim();
    }

    function csvToRows(csvText) {
      // Simple CSV parser (works with your sheet structure)
      const lines = csvText.split(/\r?\n/).filter(Boolean);
      const rows = [];
      for (let line of lines) {
        const cols = [];
        let current = "";
        let insideQuotes = false;

        for (let i = 0; i < line.length; i++) {
          const ch = line[i];

          if (ch === '"' && line[i + 1] === '"') {
            current += '"';
            i++;
          } else if (ch === '"') {
            insideQuotes = !insideQuotes;
          } else if (ch === "," && !insideQuotes) {
            cols.push(current);
            current = "";
          } else {
            current += ch;
          }
        }
        cols.push(current);
        rows.push(cols);
      }
      return rows;
    }

    function buildWhatsAppLink(whatsAppNumber, message) {
      const num = (whatsAppNumber || DEFAULT_WHATSAPP).replace(/\D/g, "");
      const text = encodeURIComponent(message);
      return `https://wa.me/${num}?text=${text}`;
    }

    function renderProperties(list) {
      const grid = document.getElementById("propertyGrid");
      const loadingText = document.getElementById("loadingText");

      grid.innerHTML = "";

      if (!list || list.length === 0) {
        loadingText.textContent = "No properties found.";
        loadingText.style.display = "block";
        return;
      }

      loadingText.style.display = "none";

      list.forEach((p) => {
        const safeType = escapeHTML(p.Type);
        const safeLocation = escapeHTML(p.Location);
        const safeArea = escapeHTML(p.Area);
        const safePrice = escapeHTML(p.Price);

        // IMPORTANT: image is full URL in your sheet
        const imgUrl = (p.Image || "").trim();

        // ALT text SEO-friendly
        const altText = `${p.Type || "Property"} in ${p.Location || "Kolkata"} - PropertiesWala`;

        const whatsappMsg =
          `Hello PropertiesWala, I am interested in this property:\n` +
          `ID: ${p.ID}\n` +
          `Category: ${p.Category}\n` +
          `Type: ${p.Type}\n` +
          `Location: ${p.Location}\n` +
          `Area: ${p.Area} sqft\n` +
          `Price: ${p.Price}\n\n` +
          `Please share more photos and arrange a site visit.`;

        const waLink = buildWhatsAppLink(p.WhatsApp, whatsappMsg);

        const card = document.createElement("div");
        card.className = "property-card";

        card.innerHTML = `
          <div class="property-image">
            <img src="${escapeHTML(imgUrl)}" alt="${escapeHTML(altText)}" loading="lazy"
              onerror="this.style.display='none'; this.parentElement.classList.add('no-image');" />
          </div>

          <div class="property-body">
            <h3>${safeType}</h3>

            <p><strong>Location:</strong> ${safeLocation}</p>
            <p><strong>Area:</strong> ${safeArea} sqft</p>
            <p><strong>Price:</strong> ${safePrice}</p>

            <a class="whatsapp-btn" target="_blank" href="${waLink}">
              WhatsApp Enquiry
            </a>
          </div>
        `;

        grid.appendChild(card);
      });
    }

    function applyFilter() {
      if (ACTIVE_FILTER === "All") {
        renderProperties(ALL_PROPERTIES);
        return;
      }
      const filtered = ALL_PROPERTIES.filter((p) => p.Category === ACTIVE_FILTER);
      renderProperties(filtered);
    }

    async function loadCSV() {
      const loadingText = document.getElementById("loadingText");
      loadingText.style.display = "block";
      loadingText.textContent = "Loading properties...";

      try {
        const res = await fetch(CSV_URL);
        const text = await res.text();

        const rows = csvToRows(text);

        // Headers expected:
        // ID, Category, Type, Location, Area, Price, Image, WhatsApp
        const headers = rows[0].map(h => h.trim());

        const data = rows.slice(1).map(row => {
          const obj = {};
          headers.forEach((h, idx) => {
            obj[h] = row[idx] ? row[idx].trim() : "";
          });

          // Ensure category normalized
          obj.Category = normalizeCategory(obj.Category);

          return obj;
        });

        // remove empty rows
        ALL_PROPERTIES = data.filter(p => p.ID && p.Type);

        applyFilter();

      } catch (err) {
        console.error(err);
        loadingText.textContent = "Error loading properties. Please check your Google Sheet publish settings.";
      }
    }

    // --------------- FILTER BUTTONS ---------------
    document.querySelectorAll(".filter-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        ACTIVE_FILTER = btn.dataset.filter;
        applyFilter();
      });
    });

    // --------------- LEAD FORM TO WHATSAPP ---------------
    document.getElementById("leadForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const name = document.getElementById("leadName").value.trim();
      const phone = document.getElementById("leadPhone").value.trim();
      const category = document.getElementById("leadCategory").value.trim();
      const type = document.getElementById("leadType").value.trim();
      const budget = document.getElementById("leadBudget").value.trim();
      const area = document.getElementById("leadArea").value.trim();

      const msg =
        `New Lead from PropertiesWala Website:\n\n` +
        `Name: ${name}\n` +
        `Phone: ${phone}\n` +
        `Category: ${category}\n` +
        `Type: ${type}\n` +
        `Budget: ${budget}\n` +
        `Preferred Area: ${area}\n\n` +
        `Please share matching verified listings.`;

      const link = buildWhatsAppLink(DEFAULT_WHATSAPP, msg);
      window.open(link, "_blank");
    });

    // Load properties
    loadCSV();
  </script>

</body>
</html>
